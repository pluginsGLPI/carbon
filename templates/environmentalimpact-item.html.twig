{#
 # -------------------------------------------------------------------------
 # Carbon plugin for GLPI
 #
 # @copyright Copyright (C) 2024-2025 Teclib' and contributors.
 # @license   https://www.gnu.org/licenses/gpl-3.0.txt GPLv3+
 # @license   MIT https://opensource.org/licenses/mit-license.php
 # @link      https://github.com/pluginsGLPI/carbon
 #
 # -------------------------------------------------------------------------
 #
 # LICENSE
 #
 # This file is part of Carbon plugin for GLPI.
 #
 # This program is free software: you can redistribute it and/or modify
 # it under the terms of the GNU General Public License as published by
 # the Free Software Foundation, either version 3 of the License, or
 # (at your option) any later version.
 #
 # This program is distributed in the hope that it will be useful,
 # but WITHOUT ANY WARRANTY; without even the implied warranty of
 # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 # GNU General Public License for more details.
 #
 # You should have received a copy of the GNU General Public License
 # along with this program.  If not, see <https://www.gnu.org/licenses/>.
 #
 # -------------------------------------------------------------------------
 #}

{% import 'components/form/fields_macros.html.twig' as fields %}

{{ fields.largeTitle(
    __('Usage', 'carbon'),
    'fas fa-chart-pie'
) }}

{{ usage_carbon_emission_graph|raw }}
<div class="card-body" id="cardBodyBorder1">
  {% if usage_impact.fields.gwp ?? null is not null %}
    <div class="h1 mb-3">{{ usage_impact.getHumanReadableImpact('gwp')|raw }}</div>
  {% endif %}

  {% if usage_impact.fields.adp ?? null is not null %}
    <div class="h1 mb-3">
      <span id="usage_abiotic_depletion_tip">
        {{ usage_impact.getHumanReadableImpact('adp')|raw }}
        {# <i class="fa-solid fa-circle-info"></i> #}
      </span>
      {{ usage_abiotic_depletion_tooltip_html|raw }}
    </div>
  {% endif %}

  {% if usage_impact.fields.pe ?? null is not null %}
    <div class="h1 mb-3">{{ usage_impact.getHumanReadableImpact('pe')|raw }}</div>
  {% endif %}
</div>

<div>
  {% if not usage_impact.isNewItem() or usage_carbon_emission_count > 0 %}
    {% set reset_args = "{_glpi_csrf_token: '" ~ csrf_token() ~ "', reset: '', itemtype: '" ~ asset.getType() ~ "', items_id: '" ~ asset.getID() ~ "'}" %}
    <a class="btn btn-primary" onclick="submitGetLink('{{ usage_impact_action_url }}', {{ reset_args }})">{{ __('Reset data', 'carbon') }}</a>
  {% endif %}
  {% set calculate_args = "{_glpi_csrf_token: '" ~ csrf_token() ~ "', calculate: '', itemtype: '" ~ asset.getType() ~ "', items_id: '" ~ asset.getID() ~ "'}" %}
  <a class="btn btn-primary" onclick="submitGetLink('{{ usage_impact_action_url }}', {{ calculate_args }})">{{ __('Calculate data', 'carbon') }}</a>
</div>

{{ fields.largeTitle(
    __('Embodied impact', 'carbon'),
    'fas fa-chart-pie'
) }}

<div class="card-body" id="cardBodyBorder1">
  {% if embodied_impact.fields.gwp ?? null is not null %}
    <div class="h1 mb-3">
      <span id="carbon_emission_tip">
        {{ embodied_impact.getHumanReadableImpact('gwp')|raw }}
        {# <i class="fa-solid fa-circle-info"></i> #}
      </span>
      {{ carbon_emission_tooltip_html|raw }}
    </div>
  {% endif %}

  {% if embodied_impact.fields.adp ?? null is not null %}
    <div class="h1 mb-3">
      <span id="embodied_abiotic_depletion_tip">
        {{ embodied_impact.getHumanReadableImpact('adp')|raw }}
        {# <i class="fa-solid fa-circle-info"></i> #}
      </span>
      {{ embodied_abiotic_depletion_tooltip_html|raw }}
    </div>
  {% endif %}

  {% if embodied_impact.fields.pe ?? null is not null %}
    <div class="h1 mb-3">
      <span id="embodied_primary_energy_tip">
        {{ embodied_impact.getHumanReadableImpact('pe')|raw }}
        {# <i class="fa-solid fa-circle-info"></i> #}
      </span>
      {{ embodied_primary_energy_tooltip_html|raw }}
    </div>
  {% endif %}

  <div>
    {% if not embodied_impact.isNewItem() %}
      {% set reset_args = "{_glpi_csrf_token: '" ~ csrf_token() ~ "', reset: '', id: '" ~ embodied_impact.getID() ~ "'}" %}
      <a class="btn btn-primary" onclick="submitGetLink('{{ embodied_impact_action_url }}', {{ reset_args }})">{{ __('Reset data', 'carbon') }}</a>
    {% endif %}
    {% set calculate_args = "{_glpi_csrf_token: '" ~ csrf_token() ~ "', calculate: '', itemtype: '" ~ asset.getType() ~ "', items_id: '" ~ asset.getID() ~ "'}" %}
    <a class="btn btn-primary" onclick="submitGetLink('{{ embodied_impact_action_url }}', {{ calculate_args }})">{{ __('Calculate data', 'carbon') }}</a>
  </div>
</div>
