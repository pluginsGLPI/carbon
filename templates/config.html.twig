{#
 # -------------------------------------------------------------------------
 # Carbon plugin for GLPI
 #
 # @copyright Copyright (C) 2024-2025 Teclib' and contributors.
 # @license   https://www.gnu.org/licenses/gpl-3.0.txt GPLv3+
 # @license   MIT https://opensource.org/licenses/mit-license.php
 # @link      https://github.com/pluginsGLPI/carbon
 #
 # -------------------------------------------------------------------------
 #
 # LICENSE
 #
 # This file is part of Carbon plugin for GLPI.
 #
 # This program is free software: you can redistribute it and/or modify
 # it under the terms of the GNU General Public License as published by
 # the Free Software Foundation, either version 3 of the License, or
 # (at your option) any later version.
 #
 # This program is distributed in the hope that it will be useful,
 # but WITHOUT ANY WARRANTY; without even the implied warranty of
 # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 # GNU General Public License for more details.
 #
 # You should have received a copy of the GNU General Public License
 # along with this program.  If not, see <https://www.gnu.org/licenses/>.
 #
 # -------------------------------------------------------------------------
 #}

{% import "components/form/fields_macros.html.twig" as fields %}

{% if can_edit %}
    <form name="form" action="{{ "Config"|itemtype_form_path }}" method="POST">
        <input type="hidden" name="config_class" value="GlpiPlugin\Carbon\Config">
        <input type="hidden" name="config_context" value="plugin:carbon">
        <input type="hidden" name="_glpi_csrf_token" value="{{ csrf_token() }}">

        {{ fields.largeTitle(
            __('Electricity maps', 'carbon'),
            'fas fa-gears'
        ) }}

        {{ fields.passwordField(
            'electricitymap_api_key',
            current_config['electricitymap_api_key'],
            __('Key for electricitymap.org API', 'carbon')
        ) }}

        {{ fields.largeTitle(
            __('Impact engine', 'carbon'),
            'fas fa-gears'
        ) }}

        <div>
            <p>{{ __('Usage carbon emissions are always calculated internally', 'carbon') }}</p>
        </div>

        {{ fields.dropdownArrayField(
            'impact_engine',
            current_config['impact_engine'],
            impact_engines,
            __('Impact engine', 'carbon')
        ) }}

        {{ fields.largeTitle(
            __('Boavizta', 'carbon'),
            'fas fa-gears'
        ) }}

        {{ fields.textField(
            'boaviztapi_base_url',
            current_config['boaviztapi_base_url'],
            __('Base URL to the Boaviztapi instance', 'carbon')
        ) }}

        <div>
            <p>{{ __('Geocoding converts a location into a ISO 3166 (3 letters) code. Boavizta needs this to determine usage impacts of assets. This feature sends the address stored in a location to nominatim.org service. If this is an issue, you can disable it below, and fill the coutry code manually.', 'carbon') }}</p>
        </div>

        {{ fields.checkboxField(
            'geocoding_enabled',
            current_config['geocoding_enabled'],
            __('Enable geocoding', 'carbon')
        ) }}

        <button type="submit" class="btn btn-primary mx-1" name="update" value="1">
            <i class="ti ti-device-floppy"></i>
            <span>{{ _x('button', 'Save') }}</span>
        </button>
    </form>
{% endif %}
